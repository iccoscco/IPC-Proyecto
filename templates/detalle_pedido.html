{% extends "base.html" %}

{% block title %}
Detalle de Pedidos
{% endblock %}

{% block content %}

<h2>Agregar detalle a un pedido</h2>
<form action="/guardar_detalles_pedido" method="POST">
    <!-- SELECT de usuario -->
    <label for="usuario">Seleccione usuario:</label>
    <select id="usuario" name="id_usuario"  required>
        <option value="" disabled selected>-- Seleccione usuario --</option>
        {% for usuario in usuarios %}
            <option value="{{ usuario.id }}">{{ usuario.nombre }}</option>
        {% endfor %}
    </select>

    <!-- SELECT de pedidos de usuario -->
    <label for="id_pedido">Seleccione pedido pendiente:</label>
    <select name="id_pedido" id="id_pedido" required>
        <option value="" disabled selected>-- Seleccione pedido --</option>
        <!--       
        {% for pedido in pedidos %}
            <option value="{{ pedido.id }}">Pedido #{{ pedido.id }}</option>
        {% endfor %} 
        -->
    </select>

    <br><br>

    <div id="menu-container">
        <div class="menu-item">
            <label>Men√∫:</label>
            <select name="id_menu[]" required>
                <option value="" disabled selected>-- Seleccione men√∫ --</option>
                {% for item in menu %}
                    <option value="{{ item.id }}">{{ item.nombre }}</option>
                {% endfor %}
            </select>

            <label>Cantidad:</label>
            <input type="number" name="cantidad[]" min="1" value="1" required>
        </div>
    </div>

    <button type="button" onclick="agregarFila()">+ A√±adir otro √≠tem</button>

    <br><br>

    <button type="submit">Guardar Todos los Detalles</button>
</form>

<!-- Boton para iniciar el automata -->
<div id="ui" style="margin: 20px 0;">
    <button type="button" onclick="iniciarAutomata()">üó£ Iniciar pedido por voz</button>
</div>

<!-- Chat para conversaci√≥n y depuraci√≥n -->
<div style="display: flex; gap: 20px;">
    <!-- Chat principal -->
    <div style="flex: 1; border: 1px solid #ccc; padding: 10px;">
        <h3>üó£Ô∏è Conversaci√≥n</h3>
        <div id="chat" style="height: 300px; overflow-y: auto;"></div>
    </div>

    <!-- Chat t√©cnico -->
    <div style="flex: 1; border: 1px solid #aaa; padding: 10px; background-color: #f9f9f9;">
        <h3>üß™ Depuraci√≥n</h3>
        <div id="debug" style="height: 300px; overflow-y: auto; font-size: 0.9em; color: #333;"></div>
    </div>
</div>

<script src="{{ url_for('static', filename='js/funciones_detalle_pedido.js') }}"></script>
{% endblock %}



